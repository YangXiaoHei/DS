* 1、**为什么要分布式？**
   * **集中式缺点：**
      * 不可能真的 “永不宕机”，一旦宕机造成单点故障，整个服务将不可用。
      * 成本高昂: 包括采购大型机的成本，培养运维人员的成本（大型机操作复杂，对掌握其原理的运维人员要求高）。
   
   * **分布式的优点**
      * **容灾: 一个翘辫子，换另一个顶上**
         * **服务副本**: 一台机器宕机（宕机或者进程 core），还有其他的主机可提供服务。
         * **数据副本**: 一台主机上的数据不可用（宕机或者数据丢失），还有其他主机上有数据的备份可用。
      * **负载均衡: 谁都别想偷懒，有难同当**
         * 数据副本或服务副本分散在不同的主机，让不同的主机一起分担热点压力。

* 2、**分布式的主要问题——数据一致性**
  
    * 既然要求数据在不同主机上都有冗余存储，那么数据的更新也必然要对每份副本进行，如果只有部分被更新，那么就造成了数据不一致。
      
    * **如何解决数据一致性问题？**
       * **简单粗暴的思路**
          * 既然数据在分布式主机间的同步需要时间，那我给你时间！直到数据的更新在所有数据副本之间传递完成前，都不能进行其他操作！换言之——阻塞该更新请求。
       * **简单粗暴的缺点**
          * 极大程度上削弱了系统的性能（吞吐量）。
      
    * **对数据一致性要求的权衡**
       * ⚠️我们无法即要严格保证数据的一致性，同时又不影响系统性能，因此针对不同业务场景，对数据一致性要求的程度进行划分。
       * 强一致性
          * 写什么读出来就是什么，最符合直觉，同时也最影响性能
       * 弱一致性
          * 写成功后不承诺立刻能读到写入的值，但尽可能保证在某个时间级别（比如秒级别）后，数据能达到一致性状态。
       * 最终一致性
          * 系统保证在一定时间内，能够达到数据一致状态，最终一致性是弱一致性的特例。

* 3、**分布式的特点**
    * **物理分布性**: 分布式系统中的多台主机在物理位置上可以随意分布
    
    * **对等性**: 分布式系统中的主机没有主/从之分，所有节点均对等。
    
    * **并发性**: 分布式系统中的多个结点会并发地访问一些共享资源。
    
    * **缺乏全局时钟**: 分布式系统中，很难定义两个事件究竟谁先谁后。
    
    * **故障一定会发生**: 任何在设计阶段考虑到的异常情况，一定会发生，在设计时未考虑到的异常故障也一定会发生。

* 4、**分布式环境的其他问题**
   * **通信异常**
      * 由于网络本身不可靠：延时、丢包
      * 延时
         * 单机内存访问在纳秒级别（通常在 10 ns左右）
         * 正常的一次网络通信在毫秒级别（0.1 ~ 100 ms左右）
      * 丢包
         * 不要以为 TCP 就一定可靠，比如，直接物理攻击切断网线呢？
   * **网络分区**
      * 出现局部小集群，在极端情况下，局部小集群会独立完成原本需要整个分布式系统才能完成的功能。
   * **三态**
      * 单机上，执行要么成功要么失败
      * 引入网络后：成功、失败、超时
   * **节点故障**
      * 每个节点都有可能不可用甚至宕机。

* **5、从 ACID 到 CAP/BASE**
   * **事务**：把对系统中对数据进行更新和访问的 `M` 个操作划分为 `N (N <= M)` 个集合，每个集合包含 `Ai ( 0 < i <= N )` 个操作，这种操作的集合叫做事务。当多个应用程序并发访问数据时，事务可以在这些应用程序之间提供一个隔离方法，以 防彼此的操作互相干扰；事务也为数据操作序列提供了从失败中恢复到正常的方法；同时提供了数据在异常状态下保持一致性的方法。
   * 事务具有下面四个特征：
      * **原子性 (Atomicity)**
         * 一个事务中的所有操作，只有都执行成功，事务才算成功完成；如果有一个操作不成功，那么整个事务失败，同时，其他已经执行的操作引起的效果都被撤销，整个数据的状态回滚到事务没有执行时的初始状态。
      * **一致性 (Consistency)**
         * 业务上理解：A 给 B 转账，事务完成后，A 和 B 的存款总额恒定不变。
         * 实现上理解：事务完成前后，**数据库的约束不变**（比如主键约束、唯一性约束、检查约束、默认约束、外键约束）；**数据库的数据结构没有被破坏** (比如 B+ 树，链表等数据结构都是正确的)
      * **隔离性 (Isolation)**
         * 事务之间互不干涉，理想情况下**事务不会查看到中间状态**。但是，完全隔离是不现实的，因为如果完全隔离，那么事务只能顺序执行，严重影响性能，在标准 SQL 规范中，定义了 4 个事务隔离等级：
         * 
      * **持久性 (Durability)**
